<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Cancelled Tournaments</title>
    <%- include("../partials/heading") %>
    <body>
      <%- include("../partials/user_nav")%>
      <section class="section">
        <% if(level){%> <%- include("../partials/search_feature") %><%}%> <% var
        f=0;if(teams_obj.length){%>
        <h1>Teams</h1>
        <div class="columns is-multiline">
          <% teams_obj.forEach(obj => { var x =
          moment(obj.start_date).format("YYYY-MM-DD"); var y =
          moment(obj.end_date).format("YYYY-MM-DD");%>

          <div class="column is-one-third">
            <div class="card">
              <div class="card-header">
                <p class="card-header-title is-centered"><%= obj.tname%></p>
              </div>
              <div class="card-content">
                <p class="card-header-subtitle"><%= obj.sport%></p>

                <p>Number Of Teams : <%=obj.numofteams%></p>
                <p>Players Per Team: <%=obj.playerspteam%></p>
                <p>Teams Registered:<%=obj.curr_num_teams%></p>

                <p></p>

                <p>Tournament Status: <%=obj.status_tournament%></p>
                <p>start_date :<%= x %></p>
                <p>end_date :<%= y %></p>
              </div>
              <footer class="card-footer">
                <button class="button card-footer-item">
                  <a
                    href="/user/tournament/<%= obj._id%>"
                    class="card-footer-item"
                  >
                    Register</a
                  >
                </button>
              </footer>
            </div>
          </div>
          <% })%>
        </div>
        <% }else { f=1; %> <%}%> <% if(single_obj.length){%>
        <h1>Single</h1>
        <div class="columns is-multiline">
          <% single_obj.forEach(obj => { var x =
          moment(obj.start_date).format("YYYY-MM-DD"); var y =
          moment(obj.end_date).format("YYYY-MM-DD");%>

          <div class="column is-one-third">
            <div class="card">
              <div class="card-header">
                <p class="card-header-title is-centered"><%= obj.tname%></p>
              </div>
              <div class="card-content">
                <p class="card-header-subtitle"><%= obj.sport%></p>

                <p>Players : <%=obj.number_single_player%></p>
                <p>Players Registered:<%=obj.curr_num_teams%></p>
                <p></p>
                <p></p>

                <p>Tournament Status: <%=obj.status_tournament%></p>
                <p>start_date :<%= x %></p>
                <p>end_date :<%= y %></p>
              </div>
              <footer class="card-footer">
                <button class="button card-footer-item">
                  <a
                    href="/user/tournament/<%= obj._id%>"
                    class="card-footer-item"
                  >
                    Register</a
                  >
                </button>
              </footer>
            </div>
          </div>
          <% })%> <% }else { if(f==1){ %>
          <div class="container">
            <h1 class="has-text-centered">NO Tournaments</h1>
          </div>
          <%}}%>
        </div>
      </section>
      <style>
        .card:hover {
          transform: translate3D(0, -1px, 0) scale(1.03);
        }
        h1 {
          font-size: xx-large;
        }
        @keyframes slideInLeft {
          0% {
            transform: translateY(-100%);
          }
          100% {
            transform: translateY(0);
          }
        }
        section {
          animation: 1s ease-out 0s 1 slideInLeft;

          padding: 40px;
        }
      </style>
      <script>
        function form_send() {
          console.log(window.location.href);
          const Url = new URL(window.location.href);
          const start_val = document.getElementById("start").value;
          console.log(start_val + " sad");
          const end_val = document.getElementById("end").value;
          if (new Date(start_val).getTime() > new Date(end_val).getTime()) {
            console.log("hi");
            document.getElementById("sm").innerText =
              "End Date should be greater than start date";
            return false;
          }
          if (start_val != "" && end_val != "") {
            Url.searchParams.set("start_date", start_val);
            Url.searchParams.set("end_date", end_val);
            console.log(Url);
            const ans = Url.pathname + Url.search;
            console.log(Url.search);
            console.log(ans);
            //  document.getElementById("theform").action = ans;
            window.location.href = ans;
            return true;
          } else if (start_val == "" && end_val == "") {
            console.log("dsasd");
            console.log(Url.searchParams.get("start_date"));
            if (
              Url.searchParams.get("start_date") &&
              Url.searchParams.get("end_date")
            ) {
              Url.searchParams.delete("start_date");
              Url.searchParams.delete("end_date");
            }
            const ans = Url.pathname + Url.search;

            window.location.href = ans;
            return true;
          } else {
            document.getElementById("sm").innerText =
              "Both dates are to be filled;";
            return false;
          }
          //console.log(document.getElementById("theform").action);
        }
      </script>
    </body>
  </head>
</html>
